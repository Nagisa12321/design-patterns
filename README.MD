# Head First Designer Patterns

___

## 1. ç­–ç•¥æ¨¡å¼([stategy](src/main/java/com/jtchen/strategy))

- ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•ç°‡, åˆ†åˆ«å°è£…èµ·æ¥, è®©å®ƒä»¬ä¹‹é—´å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ æ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨æ³•çš„å®¢æˆ·

#### ğŸºè®¾è®¡åŸåˆ™1:

- æ‰¾å‡ºåº”ç”¨ä¸­å¯èƒ½éœ€è¦å˜åŒ–çš„åœ°æ–¹, æŠŠä»–ä»¬ç‹¬ç«‹èµ·æ¥, ä¸è¦å’Œé‚£äº›ä¸éœ€è¦å˜åŒ–çš„ä»£ç æ··åœ¨ä¸€èµ·

#### ğŸºè®¾è®¡åŸåˆ™2:

- é’ˆå¯¹æ¥å£ç¼–ç¨‹, è€Œä¸æ˜¯é’ˆå¯¹å®ç°ç¼–ç¨‹

#### ğŸºè®¾è®¡åŸåˆ™3:

- å¤šç”¨ç»„åˆ, å°‘ç”¨ç»§æ‰¿

#### â­'has a' is better than 'is a'

- "æœ‰ä¸€ä¸ª"å…³ç³»ç›¸å½“æœ‰è¶£, æ¯ä¸€åªé¸­å­éƒ½æœ‰ä¸€ä¸ªfly behavior å’Œ quack behavior å¥½å°†é£è¡Œå’Œå‘±å‘±å«è¡Œä¸ºå§”æ‰˜ç»™ä»–ä»¬å¤„ç†

## 2. è§‚å¯Ÿè€…æ¨¡å¼([observer](src/main/java/com/jtchen/observer))

- è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´ä¸€å¯¹å¤šçš„ä¾èµ–, è¿™æ ·ä¸€æ¥, å½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€ æ‰€æœ‰ä¾èµ–éƒ½ä¼šæ”¶åˆ°é€šçŸ¥, è‡ªåŠ¨æ›´æ–°

#### ğŸºè®¾è®¡åŸåˆ™1:

- ä¸ºäº†äº¤äº’å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆè®¾è®¡è€ŒåŠªåŠ›

#### â­å®ç°ç»†èŠ‚

1. è‡ªå·±è®¾è®¡çš„`Observer/Subject`: è§[*weather*](src/main/java/com/jtchen/observer/weather)
2. ä½¿ç”¨`java.util`ä¸­çš„`Observable/Observer`è§[*weatherobservable*](src/main/java/com/jtchen/observer/weatherObservable)

#### â­ å…³äº`Observer::update(Observable o, Object arg)`

- `o`: ä¸»é¢˜æœ¬èº«å½“ä½œç¬¬ä¸€ä¸ªå˜é‡, å¥½è®©è§‚å¯Ÿè€…çŸ¥é“æ˜¯å“ªä¸ªå¯¹è±¡é€šçŸ¥å®ƒçš„
- `arg`: ä¼ å…¥è§‚å¯Ÿè€…çš„æ•°æ®å¯¹è±¡, å¦‚æœæ²¡æœ‰, åˆ™ä¸ºç©º

#### â­å…³äº`Observable::notifyObservers()`

- æˆ‘ç”¨çš„æ˜¯`notifyObservers(state)`(push), æŠŠçŠ¶æ€å°è£…ä¸ºä¸€ä¸ªStateå¯¹è±¡.
- ä¹¦ä¸­ç”¨çš„æ˜¯`notifyObservers()`(pull)ã€‚ç„¶åè§‚å¯Ÿè€…æ”¶åˆ°é€šçŸ¥è°ƒç”¨è‡ªå·±æƒ³è¦è°ƒç”¨çš„getteræ–¹æ³•

> ä¹¦ä¸­æ–¹æ³•æ›´èƒœä¸€ç­¹, å› ä¸ºä¸ç”¨æ¯æ¬¡éƒ½ä¼ å®Œæ•´çš„å†…éƒ¨ä¿¡æ¯ç»™è§‚å¯Ÿè€…, ä¼šé€ æˆèµ„æºçš„æµªè´¹

#### â­å…³äº`setChange()`

- `setChange()`æ–¹æ³•ç”¨æ¥æ ‡è®°å·²ç»æ”¹å˜çš„äº‹å®, å¥½è®©`notifyObservers()`çŸ¥é“å®ƒè¢«è°ƒç”¨ æ—¶åº”è¯¥é€šçŸ¥è§‚å¯Ÿè€…, å¦‚æœè°ƒç”¨`notifyObservers()`ä¹‹å‰, æ²¡æœ‰è°ƒç”¨`setChange()`, è§‚å¯Ÿè€…ä»¬å°†
  ä¸ä¼šè¢«é€šçŸ¥
    - å¦å¤–è¿˜æœ‰`clearChanged()`å’Œ`hasChanged()`, ç›¸å…³åŠŸèƒ½ä¸å†èµ˜è¿°ã€‚

#### â­ä¸è¦ä¾èµ–äºè§‚å¯Ÿè€…è¢«é€šçŸ¥çš„æ¬¡åº

- `Observable::notifyObservers()`ä¸­çš„é€šçŸ¥æ¬¡åºæ˜¯æ— åºçš„ã€‚

#### â­`java.util.Obserable`çš„é»‘æš—é¢

1. `Obserable`æ˜¯ä¸€ä¸ªç±» ä½ å¿…é¡»å¾—ç»§æ‰¿ä»–, å› æ­¤é™åˆ¶äº†å¤ç”¨çš„æ½œåŠ›ã€‚

2. `Obserable` å°†å…³é”®çš„æ–¹æ³•ä¿æŠ¤èµ·æ¥äº†, æ¯”å¦‚`setChange()`ã€‚

#### â­ swingä¸­ä¹Ÿæœ‰ç›¸åº”çš„è§‚å¯Ÿè€…æ¨¡å¼"listener"

- è¯¦è§[swing](src/main/java/com/jtchen/observer/swing/SwingObserverExample.java)

- ä¸»é¢˜: `button`, è§‚å¯Ÿè€…: ä¸¤ä¸ª`Listener`å¯¹è±¡, é€šè¿‡add...Listeneræ¥æ³¨å†Œ

# 3. è£…é¥°è€…æ¨¡å¼([decorator](src/main/java/com/jtchen/decorator))

- è£…é¥°è€…æ¨¡å¼åŠ¨æ€çš„å°†è´£ä»»é™„åŠ åˆ°å¯¹è±¡ä¸Š, è‹¥è¦æ‰©å±•åŠŸèƒ½, è£…é¥°è€…æä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆ
    - è£…é¥°è€…å’Œè¢«è£…é¥°è€…æœ‰ç›¸åŒçš„è¶…ç±»å‹
    - ä½ å¯ä»¥ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªè£…é¥°è€…åŒ…è£…ä¸€ä¸ªå¯¹è±¡
    - åœ¨ä»»ä½•éœ€è¦åŸå§‹å¯¹è±¡è¢«åŒ…è£…çš„åœºåˆ, å¯ä»¥ç”¨è£…é¥°ç€æ›¿ä»£å®ƒ
    - è£…é¥°è€…å¯ä»¥åœ¨æ‰€å§”æ‰˜çš„è¢«è£…é¥°è€…çš„è¡Œä¸ºä¹‹å‰/ä¹‹ååŠ ä¸Šè‡ªå·±çš„è¡Œä¸ºä»¥è¾¾åˆ°ç‰¹å®šçš„ç›®çš„
    - å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è¢«è£…é¥°, å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„ä¸é™é‡çš„ç”¨ä½ å–œæ¬¢çš„è£…é¥°è€…è£…é¥°å¯¹è±¡

#### â­ å…³äºStarbuzzçš„ç±»åˆå§‹è®¾è®¡

- åŸæœ¬è®¾è®¡ä¸º

```java
// çˆ¶ç±»
public abstract class Beverage {
	private String description;// ç”±æ¯ä¸ªå­ç±»è®¾ç½®, æè¿°é¥®æ–™

	public String getDescription() {
		// ...
	}

	public abstract double cost();
}

// æ¯ç§é¥®æ–™ç»§æ‰¿è¯¥çˆ¶ç±»
public class Milk extends Beverage {
	public double cost() {
		// è®¡ç®—å’–å•¡åŠ ä¸Šè®¢å•ä¸Šå„ç§è°ƒæ–™çš„ä»·é’±
	}
}

// ....
```

- è¿åäº†å“ªä¸¤ä¸ªåŸåˆ™?
    - å¤šç”¨ç»„åˆå°‘ç”¨ç»§æ‰¿
    - æ‰¾å‡ºåº”ç”¨ä¸­å¯èƒ½éœ€è¦å˜åŒ–çš„åœ°æ–¹, ä¸è¦å’Œé‚£äº›ä¸å˜çš„æ··æ‚åœ¨ä¸€èµ·

#### â­ Beverageçš„æ”¹è¿›

```java
public abstract class Beverage {

	private static final double MILK_VALUE = 10.5;
	private static final double SOY_VALUE = 5.5;
	private static final double MOCHA_VALUE = 8;
	private static final double WHIP_VALUE = 7.5;

	private String description;
	public boolean milk;
	public boolean soy;
	public boolean mocha;
	public boolean whip;

	public String getDescription() {
		return description;
	}

	public double cost() {
		double cost = 0;
		if (milk) cost += MILK_VALUE;
		if (soy) cost += SOY_VALUE;
		if (mocha) cost += MOCHA_VALUE;
		if (whip) cost += WHIP_VALUE;

		return cost;
	}

	// .....
}

```

- Beverageä¸­çš„`cost()`ä¸åœ¨æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•, æˆ‘ä»¬æä¾›äº†`cost()` çš„å®ç°, è®©ä»–è®¡ç®—è¦åŠ å…¥å„ç§é¥®æ–™çš„ä»·é’±, å­ç±»ä»å°†è¦†ç›–`cost()`, ä½†æ˜¯ä¼šè°ƒç”¨è¶…ç±»çš„`cost()`, è®¡ç®—å‡ºåŸºæœ¬é¥®æ–™åŠ ä¸Šè°ƒæ–™çš„ä»·é’±

#### ğŸº è®¾è®¡åŸåˆ™1: å¼€æ”¾-å…³é—­åŸåˆ™: ç±»åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾, å¯¹ä¿®æ”¹å…³é—­

- æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å…è®¸ç±»å®¹æ˜“æ‰©å±•, åœ¨ä¸ä¿®æ”¹ç°æœ‰ä»£ç çš„æƒ…å†µä¸‹, å°±èƒ½æ­é…æ–°çš„è¡Œä¸ºã€‚
- ä¸å¿…è¦è®©è®¾è®¡çš„æ¯ä¸ªéƒ¨åˆ†éµå®ˆå¼€æ”¾-å…³é—­åŸåˆ™, é€šå¸¸ä¼šå¼•å…¥æ–°çš„æŠ½è±¡å±‚æ¬¡ã€‚å¢åŠ ä»£ç å¤æ‚åº¦

#### â­ åˆ©ç”¨è£…é¥°å™¨æ¨¡å¼ä¹¦å†™Beverage

- [StarBuzz](src/main/java/com/jtchen/decorator/starbuzz)

- æˆ‘ä»¬è™½ç„¶ç”¨åˆ°äº†ç»§æ‰¿, ä½†æ˜¯æˆ‘ä»¬ç”¨ç»§æ‰¿è¾¾åˆ°"ç±»å‹åŒ¹é…", è€Œä¸æ˜¯è·å¾—æŸç§"è¡Œä¸º"ã€‚

- ä¹¦å†™å®Œæˆå, å¯ä»¥å¦‚ä¸‹æ·»åŠ è£…é¥°è€…, è€Œä¸”é¡ºåºæ— å…³, å¯é‡å¤æ·»åŠ 

```
Beverage beverage1 = new HouseBlend();
        beverage1 = new Soy(beverage1);
        beverage1 = new Mocha(beverage1);
        beverage1 = new Mocha(beverage1);
        beverage1 = new Whip(beverage1);
        System.out.println(beverage1.getDescription() + " $" + beverage1.cost());

[sout]: House Blend Coffee, Soy, Mocha, Mocha, Whip $1.54

```

- å·¥å‚æ¨¡å¼æˆ–è€…ç”Ÿæˆå™¨æ¨¡å¼å°†ä¼šå¯¹è£…é¥°è€…æ¨¡å¼å°è£…çš„æ›´å¥½, ä¸ç”¨æ‹…å¿ƒæ²¡æœ‰ä½¿ç”¨åˆ°æœ€å¤–åœˆçš„è£…é¥°è€…

#### â­ çœŸå®ä¸–ç•Œçš„è£…é¥°è€…æ¨¡å¼ -- InputStream

- æŠ½è±¡ç±»InputStreamç›¸å½“äºæˆ‘ä»¬çš„Beverageç±»

- ç»§æ‰¿äºInputStreamçš„FileInputStream, StringBufferInputStream, ByteArrayInputStreamç­‰ç›¸å½“äºæˆ‘ä»¬çš„å…·ä½“é¥®æ–™

- FilterInputStreamæ˜¯ä¸€ä¸ªæŠ½è±¡è£…é¥°è€…, ç›¸å½“äºæˆ‘ä»¬çš„CondimentDecoratorã€‚

- ç»§æ‰¿äºFilterInputStreamæ˜¯å…·ä½“çš„è£…é¥°è€…, å¯ä»¥è£…é¥°FileInputStream...ç­‰

- [å®ç°è‡ªå·±çš„InputStreamè£…é¥°å™¨](src/main/java/com/jtchen/decorator/io/LowerCaseInputStream.java)

### â­ è¦ç‚¹

1. ç»§æ‰¿å±äºæ‰©å±•å½¢å¼ä¹‹ä¸€, ä½†ä¸è§å¾—æ˜¯è¾¾åˆ°å¼¹æ€§è®¾è®¡çš„æœ€ä½³æ–¹æ³•
2. åœ¨æˆ‘ä»¬çš„å®é™…ä¸­ï¼Œ åº”è¯¥å…è®¸è¡Œä¸ºå¯ä»¥è¢«æ‰©å±•, è€Œæ— éœ€ä¿®æ”¹ç°æœ‰çš„ä»£ç 
3. ç»„åˆå’Œå§”æ‰˜æœ‰åˆ©äºè¿è¡Œæ—¶åŠ¨æ€åŠ ä¸Šæ–°çš„è¡Œä¸º
4. é™¤äº†ç»§æ‰¿, è£…é¥°è€…æ¨¡å¼ä¹Ÿå¯ä»¥è®©æˆ‘ä»¬æ‰©å±•è¡Œä¸º
5. è£…é¥°è€…æ¨¡å¼æ„å‘³ç€**ä¸€ç¾¤è£…é¥°è€…ç±»**, è¿™äº›ç±»ç”¨æ¥åŒ…è£…å…·ä½“ç»„ä»¶
6. è£…é¥°è€…ç±»åæ˜ å‡ºè¢«è£…é¥°çš„ç»„ä»¶ç±»å‹, **äº‹å®ä¸Šå®ƒä»¬å…·æœ‰ç›¸åŒçš„ç±»å‹**, éƒ½æ˜¯ç»è¿‡æ¥å£æˆ–è€…ç»§æ‰¿å®ç°
7. è£…é¥°è€…å¯ä»¥åœ¨è¢«è£…é¥°ç€çš„å‰é¢æˆ–è€…åé¢åŠ ä¸Šè‡ªå·±çš„è¡Œä¸º, ç”šè‡³å¯ä»¥å°†è¢«è£…é¥°è€…çš„è¡Œä¸ºæ•´ä¸ªå–ä»£æ‰, è€Œè¾¾åˆ°ç‰¹å®šçš„ç›®çš„
8. ä½ å¯ä»¥ç”¨**æ— æ•°**ä¸ªè£…é¥°è€…è£…é¥°ç‰¹å®šçš„ç»„ä»¶
9. è£…é¥°è€…ä¸€èˆ¬å¯¹ç»„ä»¶çš„å®¢æˆ·æ˜¯é€æ˜çš„, é™¤éå®¢æˆ·ä¾èµ–äºç»„ä»¶çš„å…·ä½“ç±»å‹
10. è£…é¥°è€…ä¼šå¯¼è‡´è®¾è®¡ä¸­å‡ºç°å¾ˆå¤šå°å¯¹è±¡, ä¼šè®©ç¨‹åºå˜å¾—å¤æ‚